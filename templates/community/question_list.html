{% extends 'base.html' %}
{% load pybo_filter %}
{% load static %}

{% block extra_css %}
<link href="{% static 'css/premium.css' %}?v={{ 'now'|date:'YmdHis' }}" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-premium">
    <div class="hero-premium-content">
        <h1 class="hero-premium-title">테크창</h1>
        <p class="hero-premium-subtitle">
            HRD와 테크놀로지 지식을 공유하는 커뮤니티<br>
            데이터 분석부터 프로그래밍까지, AI 시대의 인재개발 혁신
        </p>

        <div class="hero-premium-actions">
            {% if user.is_authenticated %}
                <a href="{% url 'community:question_create' %}" class="btn-premium btn-premium-primary">
                    게시글 작성
                </a>
                <a href="{% url 'community:games_index' %}" class="btn-premium btn-premium-secondary">
                    게임 센터
                </a>
                {% if user.is_staff or user.is_superuser %}
                <a href="{% url 'common:admin_dashboard' %}" class="btn-premium btn-premium-admin" style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; border: none;">
                    <i class="fas fa-shield-alt me-1"></i>관리자 대시보드
                </a>
                {% endif %}
            {% else %}
                <a href="{% url 'common:login' %}" class="btn-premium btn-premium-primary">
                    시작하기
                </a>
                <a href="{% url 'common:signup' %}" class="btn-premium btn-premium-secondary">
                    회원가입
                </a>
            {% endif %}
        </div>

        <!-- Stats -->
        <div class="stats-premium">
            <div class="stat-premium">
                <div class="stat-premium-value">{{ total_count }}</div>
                <div class="stat-premium-label">게시글</div>
            </div>
            <div class="stat-premium">
                <div class="stat-premium-value">{{ categories|length }}</div>
                <div class="stat-premium-label">카테고리</div>
            </div>
            <div class="stat-premium">
                <div class="stat-premium-value">{{ launch_days }}</div>
                <div class="stat-premium-label">운영 일수</div>
            </div>
        </div>
    </div>
</section>

<!-- Categories -->
<section class="container-premium" style="padding: var(--space-16) var(--space-8);">
    <div class="category-pills">
        <a href="?page=1" class="category-pill {% if not category %}active{% endif %}">
            전체 ({{ total_count }})
        </a>
        {% for cat in categories %}
        <a href="?category={{ cat.name }}&page=1" class="category-pill {% if category == cat.name %}active{% endif %}">
            {{ cat.name }}
        </a>
        {% endfor %}
    </div>
</section>

<!-- Posts Section -->
<section class="posts-premium">
    <h2 class="posts-premium-title">최신 게시글</h2>

    <div class="bento-grid">
        {% for question in question_list %}
        <a href="{% url 'community:detail' question.id %}" class="post-card">
            {% if question.category %}
                {% if question.category.name == 'HRD' %}
                    <span class="post-card-badge badge-hrd">{{ question.category.name }}</span>
                {% elif question.category.name == '데이터분석' %}
                    <span class="post-card-badge badge-data">{{ question.category.name }}</span>
                {% elif question.category.name == '프로그래밍' %}
                    <span class="post-card-badge badge-programming">{{ question.category.name }}</span>
                {% elif question.category.name == '공지사항' %}
                    <span class="post-card-badge badge-notice">{{ question.category.name }}</span>
                {% else %}
                    <span class="post-card-badge badge-free">{{ question.category.name }}</span>
                {% endif %}
            {% endif %}

            <h3 class="post-card-title">{{ question.subject }}</h3>

            <div class="post-card-meta">
                <span>추천 {{ question.voter.count }}</span>
                <span>답변 {{ question.answer_set.count }}</span>
                <span>{{ question.create_date|date:"m-d" }}</span>
            </div>
        </a>
        {% empty %}
        <div style="grid-column: 1 / -1; text-align: center; padding: var(--space-16); color: var(--text-tertiary);">
            <p style="font-size: 1.25rem;">게시글이 없습니다.</p>
        </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if question_list.has_other_pages %}
    <div class="pagination-premium">
        {% if question_list.has_previous %}
            <a href="?page=1{% if category %}&category={{ category }}{% endif %}{% if kw %}&kw={{ kw }}{% endif %}">«</a>
            <a href="?page={{ question_list.previous_page_number }}{% if category %}&category={{ category }}{% endif %}{% if kw %}&kw={{ kw }}{% endif %}">‹</a>
        {% endif %}

        <span class="active">{{ question_list.number }}</span>

        {% if question_list.has_next %}
            <a href="?page={{ question_list.next_page_number }}{% if category %}&category={{ category }}{% endif %}{% if kw %}&kw={{ kw }}{% endif %}">›</a>
            <a href="?page={{ question_list.paginator.num_pages }}{% if category %}&category={{ category }}{% endif %}{% if kw %}&kw={{ kw }}{% endif %}">»</a>
        {% endif %}
    </div>
    {% endif %}
</section>

<!-- Search Form -->
<form id="searchForm" method="get" action="{% url 'community:index' %}" style="display: none;">
    <input type="hidden" id="kw" name="kw" value="{{ kw|default_if_none:'' }}">
    <input type="hidden" id="page" name="page" value="{{ page }}">
    <input type="hidden" id="category" name="category" value="{{ category }}">
</form>

{% endblock %}
