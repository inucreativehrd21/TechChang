{% extends 'base_mobile.html' %}
{% load common_tags %}

{% block title %}ì§€ë¢°ì°¾ê¸° ë¦¬ë”ë³´ë“œ - í…Œí¬ì°½{% endblock %}
{% block tab_games %}active{% endblock %}

{% block extra_css %}
<style>
.m-lb-header {
    padding: 20px 16px 12px;
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    color: #fff; text-align: center;
}
.m-diff-tabs {
    display: flex; gap: 8px; padding: 12px 16px;
    background: var(--bg-secondary, #f9fafb);
    border-bottom: 1px solid var(--border-light, #e5e7eb);
    overflow-x: auto;
}
.m-diff-tab {
    padding: 7px 16px; border-radius: 20px;
    font-size: 0.8125rem; font-weight: 700;
    white-space: nowrap; text-decoration: none;
    background: var(--bg-primary, #fff); color: var(--text-secondary, #6b7280);
    border: 1.5px solid var(--border-light, #e5e7eb);
}
.m-diff-tab.active { background: #4facfe; color: #fff; border-color: #4facfe; }
.m-lb-row {
    display: flex; align-items: center; gap: 12px;
    padding: 12px 16px;
    border-bottom: 1px solid var(--border-light, #f3f4f6);
    background: var(--bg-primary, #fff);
}
.m-lb-rank {
    width: 36px; height: 36px; border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.9375rem; font-weight: 800;
    background: var(--bg-secondary, #f3f4f6);
    color: var(--text-secondary, #6b7280); flex-shrink: 0;
}
.m-lb-rank.r1 { background: linear-gradient(135deg, #facc15, #eab308); color: #111; }
.m-lb-rank.r2 { background: linear-gradient(135deg, #e5e7eb, #cbd5e1); color: #111; }
.m-lb-rank.r3 { background: linear-gradient(135deg, #f59e0b, #d97706); color: #111; }
.m-lb-avatar {
    width: 40px; height: 40px; border-radius: 50%;
    background: linear-gradient(135deg, #4facfe, #00f2fe);
    display: flex; align-items: center; justify-content: center;
    color: #fff; font-weight: 800; font-size: 1rem;
    flex-shrink: 0; overflow: hidden;
}
.m-lb-avatar img { width: 100%; height: 100%; object-fit: cover; }
.m-lb-info { flex: 1; min-width: 0; }
.m-lb-name { font-size: 0.9375rem; font-weight: 700; color: var(--text-primary, #111); }
.m-lb-stats { font-size: 0.75rem; color: var(--text-secondary, #6b7280); margin-top: 2px; }
.m-lb-score { text-align: right; flex-shrink: 0; }
.m-lb-score-val { font-size: 1.0625rem; font-weight: 800; color: #4facfe; }
.m-lb-score-label { font-size: 0.6875rem; color: var(--text-tertiary, #9ca3af); }
.m-empty { text-align: center; padding: 40px 20px; color: var(--text-tertiary, #9ca3af); font-size: .875rem; }
.m-lb-actions { padding: 16px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.m-btn-ghost {
    padding: 13px; border-radius: 12px; background: var(--bg-secondary, #f9fafb);
    color: var(--text-secondary, #6b7280); border: 1.5px solid var(--border-light, #e5e7eb);
    font-weight: 600; font-size: 0.875rem; text-align: center; text-decoration: none; display: block;
}
.m-btn-play {
    padding: 13px; border-radius: 12px;
    background: #4facfe; color: #fff;
    font-weight: 600; font-size: 0.875rem; text-align: center; text-decoration: none; display: block;
}
</style>
{% endblock %}

{% block content %}
<div class="m-lb-header">
    <div style="font-size:1.5rem;margin-bottom:4px;">ğŸ’£</div>
    <div style="font-size:1.25rem;font-weight:800;">ì§€ë¢°ì°¾ê¸° ë¦¬ë”ë³´ë“œ</div>
    <div style="font-size:0.8125rem;opacity:.9;margin-top:2px;">{{ total_players }}ëª…ì˜ í”Œë ˆì´ì–´</div>
</div>

<!-- ë‚œì´ë„ íƒ­ -->
<div class="m-diff-tabs">
    <a href="?difficulty=easy" class="m-diff-tab {% if difficulty == 'easy' %}active{% endif %}">ì‰¬ì›€</a>
    <a href="?difficulty=medium" class="m-diff-tab {% if difficulty == 'medium' %}active{% endif %}">ë³´í†µ</a>
    <a href="?difficulty=hard" class="m-diff-tab {% if difficulty == 'hard' %}active{% endif %}">ì–´ë ¤ì›€</a>
</div>

{% if leaderboard %}
{% for entry in leaderboard %}
<div class="m-lb-row">
    <div class="m-lb-rank {% if entry.rank == 1 %}r1{% elif entry.rank == 2 %}r2{% elif entry.rank == 3 %}r3{% endif %}">{{ entry.rank }}</div>
    <div class="m-lb-avatar">
        {% if entry.profile_image %}
        <img src="{{ entry.profile_image }}" alt="">
        {% else %}
        {{ entry.display_name|slice:":1"|upper }}
        {% endif %}
    </div>
    <div class="m-lb-info">
        <div class="m-lb-name">{{ entry.display_name }}</div>
        <div class="m-lb-stats">{{ entry.wins }}ìŠ¹ / {{ entry.total_games }}íŒ Â· ìŠ¹ë¥  {{ entry.win_rate }}%</div>
    </div>
    <div class="m-lb-score">
        <div class="m-lb-score-val">{{ entry.best_time }}s</div>
        <div class="m-lb-score-label">ìµœê³  ê¸°ë¡</div>
    </div>
</div>
{% endfor %}
{% else %}
<div class="m-empty">
    <i class="fas fa-trophy" style="font-size:2rem;display:block;margin-bottom:8px;"></i>
    ì´ ë‚œì´ë„ì˜ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.
</div>
{% endif %}

<div class="m-lb-actions">
    <a href="{% url 'community:minesweeper_start' %}" class="m-btn-ghost"><i class="fas fa-play me-2"></i>ê²Œì„ ì‹œì‘</a>
    <a href="{% url 'community:games_index' %}" class="m-btn-play"><i class="fas fa-gamepad me-2"></i>ê²Œì„ ëª©ë¡</a>
</div>
{% endblock %}
