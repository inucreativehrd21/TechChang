{% extends 'base.html' %}
{% load pybo_filter %}
{% load static %}

{% block extra_css %}
<link href="{% static 'css/reborn.css' %}?v={{ 'now'|date:'YmdHis' }}" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- Hero Section - Clean & Professional -->
<section class="hero-section">
    <!-- ë¯¸ë¬˜í•œ ë°°ê²½ ì¥ì‹ -->
    <div class="bg-decoration">
        <div class="bg-blob bg-blob-1"></div>
        <div class="bg-blob bg-blob-2"></div>
    </div>

    <div class="hero-content fade-in">
        <!-- Badge -->
        <div style="text-align: center; margin-bottom: var(--space-4);">
            <span class="badge badge-featured">HRD Ã— Technology Ã— Innovation</span>
        </div>

        <!-- Main Title -->
        <h1 class="display-mega text-center">í…Œí¬ì°½</h1>
        <h2 class="display-lg text-center text-gradient-accent" style="margin-bottom: var(--space-6);">
            ì§€ì‹ì´ ì„±ì¥í•˜ëŠ” ì°½ì¡°ì  ê³µê°„
        </h2>

        <!-- Description -->
        <p class="fade-in stagger-2" style="
            font-size: 1.25rem;
            line-height: 1.8;
            color: var(--text-secondary);
            max-width: 700px;
            margin: 0 auto var(--space-8);
            text-align: center;
        ">
            ë°ì´í„° ë¶„ì„ë¶€í„° í”„ë¡œê·¸ë˜ë°ê¹Œì§€, AI ì‹œëŒ€ì˜ ì¸ì¬ê°œë°œ í˜ì‹ ì„ í•¨ê»˜ ë§Œë“¤ì–´ê°‘ë‹ˆë‹¤.
        </p>

        <!-- CTA Buttons -->
        <div class="fade-in stagger-3" style="display: flex; gap: var(--space-4); justify-content: center; flex-wrap: wrap; margin-bottom: var(--space-12);">
            {% if user.is_authenticated %}
                <a href="{% url 'pybo:question_create' %}" class="btn-primary">
                    âœï¸ ê²Œì‹œê¸€ ì‘ì„±
                </a>
                <a href="{% url 'pybo:games_index' %}" class="btn-secondary">
                    ğŸ® ê²Œì„ ì„¼í„°
                </a>
            {% else %}
                <a href="{% url 'common:login' %}" class="btn-primary">
                    ğŸš€ ì‹œì‘í•˜ê¸°
                </a>
                <a href="{% url 'common:signup' %}" class="btn-secondary">
                    ğŸ“ íšŒì›ê°€ì…
                </a>
            {% endif %}
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid fade-in stagger-4" style="max-width: 800px; margin: 0 auto;">
            <div class="stat-card">
                <div class="stat-value">{{ total_count }}</div>
                <div class="stat-label">ê²Œì‹œê¸€</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ categories|length }}</div>
                <div class="stat-label">ì¹´í…Œê³ ë¦¬</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{% if user.is_authenticated %}ON{% else %}OFF{% endif %}</div>
                <div class="stat-label">ìƒíƒœ</div>
            </div>
        </div>
    </div>
</section>

<!-- Categories Section - ì½˜í…ì¸  ìœ„ë¡œ ì´ë™ -->
<section class="section" style="padding-top: var(--space-8); padding-bottom: var(--space-8); background: var(--bg-primary);">
    <div class="container-wide">
        <h2 class="section-title" style="font-size: 1.5rem; margin-bottom: var(--space-6);">ì¹´í…Œê³ ë¦¬</h2>

        <div class="category-scroll">
            <a href="?page=1" class="category-pill {% if not category %}active{% endif %}">
                ğŸŒ ì „ì²´ ({{ total_count }})
            </a>

            {% for cat in categories %}
            <a href="?category={{ cat.name }}&page=1" class="category-pill {% if category == cat.name %}active{% endif %}">
                {{ cat.name }} {% if category == cat.name %}({{ category_counts|get_item:cat.name }}){% endif %}
            </a>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Content Section - Bento Grid -->
<section class="section" style="background: var(--bg-secondary);">
    <div class="container-wide">
        <h2 class="section-title">ìµœì‹  ì½˜í…ì¸ </h2>

        <div class="bento-container">
            <!-- Featured Post -->
            {% if question_list.0 %}
            <div class="bento-featured fade-in">
                <span class="badge badge-featured">Featured</span>
                <h3 style="font-size: 2rem; font-weight: 800; margin: var(--space-4) 0; line-height: 1.2;">
                    <a href="{% url 'pybo:detail' question_list.0.id %}" style="color: var(--text-primary); text-decoration: none;">
                        {{ question_list.0.subject }}
                    </a>
                </h3>
                <p style="color: var(--text-secondary); line-height: 1.6; margin-bottom: var(--space-6);">
                    {{ question_list.0.content|striptags|truncatewords:30 }}
                </p>
                <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.875rem; color: var(--text-tertiary);">
                    <div style="display: flex; gap: var(--space-3);">
                        <span>â¤ï¸ {{ question_list.0.voter.count }}</span>
                        <span>ğŸ’¬ {{ question_list.0.answer_set.count }}</span>
                    </div>
                    <span>{{ question_list.0.create_date|date:"m-d H:i" }}</span>
                </div>
            </div>
            {% endif %}

            <!-- Regular Posts -->
            {% for question in question_list|slice:"1:13" %}
            <div class="bento-item fade-in stagger-{{ forloop.counter }}">
                {% if question.category %}
                <span class="badge">{{ question.category.name }}</span>
                {% endif %}
                <h3 style="font-size: 1.25rem; font-weight: 700; margin: var(--space-3) 0; line-height: 1.3;">
                    <a href="{% url 'pybo:detail' question.id %}" style="color: var(--text-primary); text-decoration: none;">
                        {{ question.subject|truncatewords:12 }}
                    </a>
                </h3>
                <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.875rem; color: var(--text-tertiary); margin-top: auto;">
                    <span>â¤ï¸ {{ question.voter.count }} ğŸ’¬ {{ question.answer_set.count }}</span>
                    <span>{{ question.create_date|date:"m-d" }}</span>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Pagination -->
        {% if question_list.has_other_pages %}
        <div style="display: flex; justify-content: center; gap: var(--space-2); margin-top: var(--space-12);">
            {% if question_list.has_previous %}
                <a href="?page=1{% if category %}&category={{ category }}{% endif %}{% if kw %}&kw={{ kw }}{% endif %}" class="btn-secondary" style="padding: var(--space-3) var(--space-4);">Â«</a>
                <a href="?page={{ question_list.previous_page_number }}{% if category %}&category={{ category }}{% endif %}{% if kw %}&kw={{ kw }}{% endif %}" class="btn-secondary" style="padding: var(--space-3) var(--space-4);">â€¹</a>
            {% endif %}

            <span class="btn-primary" style="padding: var(--space-3) var(--space-5);">
                {{ question_list.number }}
            </span>

            {% if question_list.has_next %}
                <a href="?page={{ question_list.next_page_number }}{% if category %}&category={{ category }}{% endif %}{% if kw %}&kw={{ kw }}{% endif %}" class="btn-secondary" style="padding: var(--space-3) var(--space-4);">â€º</a>
                <a href="?page={{ question_list.paginator.num_pages }}{% if category %}&category={{ category }}{% endif %}{% if kw %}&kw={{ kw }}{% endif %}" class="btn-secondary" style="padding: var(--space-3) var(--space-4);">Â»</a>
            {% endif %}
        </div>
        {% endif %}
    </div>
</section>

<!-- Search Form (Hidden) -->
<form id="searchForm" method="get" action="{% url 'pybo:index' %}" style="display: none;">
    <input type="hidden" id="kw" name="kw" value="{{ kw|default_if_none:'' }}">
    <input type="hidden" id="page" name="page" value="{{ page }}">
    <input type="hidden" id="sort" name="sort" value="{{ sort }}">
    <input type="hidden" id="category" name="category" value="{{ category }}">
</form>

{% endblock %}

{% block script %}
<script>
// ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth'
            });
        }
    });
});
</script>
{% endblock %}
