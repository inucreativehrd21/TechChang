{% extends 'base.html' %}
{% load static %}
{% load pybo_filter %}

{% block title %}ê²Œì„ ì„¼í„° - TechChang Games{% endblock %}

{% block extra_css %}
<link href="{% static 'css/reborn.css' %}?v={{ 'now'|date:'YmdHis' }}" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- Particle Background -->
<div class="particle-bg">
    {% for i in "123456789012" %}
    <div class="particle" style="
        left: {{ forloop.counter|add:15|mul:7 }}%;
        animation-delay: {{ forloop.counter|mul:0.7 }}s;
        animation-duration: {{ forloop.counter|add:18 }}s;
    "></div>
    {% endfor %}
</div>

<!-- Hero Section -->
<section style="position: relative; overflow: hidden; padding: var(--space-20) var(--space-6); text-align: center;">
    <!-- Blobs -->
    <div class="blob blob-purple" style="width: 500px; height: 500px; top: -200px; left: 10%; animation-delay: 0s;"></div>
    <div class="blob blob-pink" style="width: 600px; height: 600px; bottom: -250px; right: 5%; animation-delay: 7s;"></div>
    <div class="blob blob-teal" style="width: 400px; height: 400px; top: 30%; right: 15%; animation-delay: 14s;"></div>

    <div style="position: relative; z-index: 2;">
        <div class="bounce-in">
            <span style="
                display: inline-block;
                padding: var(--space-2) var(--space-5);
                background: var(--gradient-primary);
                color: white;
                border-radius: 999px;
                font-size: 0.875rem;
                font-weight: 700;
                letter-spacing: 0.1em;
                text-transform: uppercase;
                box-shadow: 0 4px 14px rgba(139, 92, 246, 0.4);
                margin-bottom: var(--space-4);
            ">
                ğŸ® PLAY & WIN
            </span>
        </div>

        <h1 class="display-mega bounce-in stagger-1" style="margin-bottom: var(--space-6);">
            ê²Œì„ ì„¼í„°
        </h1>

        <p class="bounce-in stagger-2" style="
            font-size: 1.5rem;
            color: var(--text-secondary);
            max-width: 700px;
            margin: 0 auto var(--space-12);
        ">
            ì‹¤ì‹œê°„ ë©€í‹°í”Œë ˆì´ì–´ë¶€í„° í¼ì¦ê¹Œì§€,<br>
            ë‹¤ì–‘í•œ ê²Œì„ìœ¼ë¡œ ì‹¤ë ¥ì„ ê²¨ë¤„ë³´ì„¸ìš”
        </p>

        <!-- Stats -->
        <div class="elastic-in stagger-3" style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-4);
            max-width: 600px;
            margin: 0 auto;
        ">
            <div class="glass-purple card-3d neon-purple" style="
                padding: var(--space-6);
                border-radius: var(--radius-2xl);
            ">
                <div style="font-size: 3rem; font-weight: 900;">{{ recent_stats.total_games_played }}</div>
                <div style="font-size: 0.875rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-top: var(--space-2);">Total Games</div>
            </div>
            <div class="glass-pink card-3d neon-pink" style="
                padding: var(--space-6);
                border-radius: var(--radius-2xl);
            ">
                <div style="font-size: 3rem; font-weight: 900;">{% if user.is_authenticated %}ON{% else %}OFF{% endif %}</div>
                <div style="font-size: 0.875rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-top: var(--space-2);">Status</div>
            </div>
        </div>
    </div>
</section>

<!-- Games Bento Grid -->
<section class="container-fluid" style="padding: var(--space-12) var(--space-6);">
    <h2 class="display-lg text-gradient-dynamic text-center morph-in" style="margin-bottom: var(--space-12);">
        ëª¨ë“  ê²Œì„
    </h2>

    <div class="bento-container">
        {% for game in games_info %}
        {% if forloop.counter == 1 %}
        <!-- First game is featured -->
        <div class="bento-item bento-featured glass-rainbow card-3d holographic morph-in stagger-1">
            <div style="height: 100%; display: flex; flex-direction: column; justify-content: space-between;">
                <div>
                    <div style="font-size: 5rem; margin-bottom: var(--space-4); text-align: center; animation: float 3s ease-in-out infinite;">
                        {{ game.icon }}
                    </div>
                    <h3 class="text-gradient-dynamic" style="font-size: 2.5rem; font-weight: 900; margin-bottom: var(--space-3); text-align: center;">
                        {{ game.name }}
                    </h3>
                    <p style="font-size: 1rem; color: var(--text-secondary); text-align: center; margin-bottom: var(--space-6);">
                        {{ game.description }}
                    </p>
                </div>

                <div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-3); margin-bottom: var(--space-6);">
                        <div style="text-align: center; padding: var(--space-4); background: rgba(255, 255, 255, 0.1); border-radius: var(--radius-lg);">
                            <div style="font-size: 2rem; font-weight: 900;">{{ game.total_games }}</div>
                            <div style="font-size: 0.75rem; opacity: 0.8; text-transform: uppercase;">ì´ ê²Œì„</div>
                        </div>
                        <div style="text-align: center; padding: var(--space-4); background: rgba(255, 255, 255, 0.1); border-radius: var(--radius-lg);">
                            <div style="font-size: 2rem; font-weight: 900;">{{ game.active_games }}</div>
                            <div style="font-size: 0.75rem; opacity: 0.8; text-transform: uppercase;">ì§„í–‰ ì¤‘</div>
                        </div>
                    </div>

                    <a href="{% url game.url %}" class="btn-liquid btn-morphing" style="
                        display: block;
                        padding: var(--space-5);
                        background: white;
                        color: var(--primary-600);
                        font-size: 1.125rem;
                        font-weight: 800;
                        text-align: center;
                        text-decoration: none;
                        border-radius: var(--radius-xl);
                    ">
                        í”Œë ˆì´ í•˜ê¸° â–¶
                    </a>
                </div>
            </div>
        </div>
        {% else %}
        <!-- Regular games -->
        <div class="bento-item {% cycle 'glass-purple' 'glass-pink' 'glass-teal' %} card-3d morph-in stagger-{{ forloop.counter }}">
            <div style="height: 100%; display: flex; flex-direction: column; justify-content: space-between;">
                <div>
                    <div style="font-size: 3rem; margin-bottom: var(--space-3); animation: float 3s ease-in-out infinite;">
                        {{ game.icon }}
                    </div>
                    <h3 style="font-size: 1.5rem; font-weight: 800; margin-bottom: var(--space-2);">
                        {{ game.name }}
                    </h3>
                    <p style="font-size: 0.875rem; opacity: 0.8; text-transform: uppercase; margin-bottom: var(--space-3);">
                        {{ game.title }}
                    </p>
                    <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: var(--space-4);">
                        {{ game.description|truncatewords:15 }}
                    </p>
                </div>

                <div>
                    <div style="display: flex; gap: var(--space-3); margin-bottom: var(--space-4); font-size: 0.875rem;">
                        <span>ğŸ¯ {{ game.total_games }}</span>
                        <span>ğŸ”¥ {{ game.active_games }}</span>
                    </div>

                    <a href="{% url game.url %}" class="btn-liquid" style="
                        display: block;
                        padding: var(--space-4);
                        background: rgba(255, 255, 255, 0.2);
                        font-weight: 700;
                        text-align: center;
                        text-decoration: none;
                        color: inherit;
                        border-radius: var(--radius-lg);
                        border: 1px solid rgba(255, 255, 255, 0.3);
                    ">
                        í”Œë ˆì´ â–¶
                    </a>
                </div>
            </div>
        </div>
        {% endif %}
        {% endfor %}
    </div>
</section>

<!-- Features Section -->
<section class="container-fluid" style="padding: var(--space-12) var(--space-6);">
    <h2 class="display-lg text-gradient-dynamic text-center bounce-in" style="margin-bottom: var(--space-12);">
        ê²Œì„ íŠ¹ì§•
    </h2>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--space-6);">
        <div class="glass-purple card-3d bounce-in stagger-1" style="padding: var(--space-8); border-radius: var(--radius-2xl); text-align: center;">
            <div style="font-size: 4rem; margin-bottom: var(--space-4);">âš¡</div>
            <h3 style="font-size: 1.5rem; font-weight: 800; margin-bottom: var(--space-3);">ì‹¤ì‹œê°„ ê²Œì„</h3>
            <p style="line-height: 1.6; opacity: 0.9;">
                WebSocket ê¸°ìˆ ë¡œ êµ¬í˜„ëœ ì‹¤ì‹œê°„ ë©€í‹°í”Œë ˆì´ì–´ ê²Œì„. ëë§ì‡ê¸°ì™€ í‹±íƒí† ì—ì„œ ë‹¤ë¥¸ í”Œë ˆì´ì–´ì™€ ì¦‰ì‹œ ëŒ€ê²°í•˜ì„¸ìš”!
            </p>
        </div>

        <div class="glass-pink card-3d bounce-in stagger-2" style="padding: var(--space-8); border-radius: var(--radius-2xl); text-align: center;">
            <div style="font-size: 4rem; margin-bottom: var(--space-4);">ğŸ¯</div>
            <h3 style="font-size: 1.5rem; font-weight: 800; margin-bottom: var(--space-3);">ì‹±ê¸€ í”Œë ˆì´</h3>
            <p style="line-height: 1.6; opacity: 0.9;">
                ìˆ«ìì•¼êµ¬, 2048, ì§€ë¢°ì°¾ê¸° ë“± í˜¼ìì„œë„ ì¦ê¸¸ ìˆ˜ ìˆëŠ” í¼ì¦ ê²Œì„. ìì‹ ì˜ ìµœê³  ê¸°ë¡ì— ë„ì „í•˜ì„¸ìš”!
            </p>
        </div>

        <div class="glass-teal card-3d bounce-in stagger-3" style="padding: var(--space-8); border-radius: var(--radius-2xl); text-align: center;">
            <div style="font-size: 4rem; margin-bottom: var(--space-4);">ğŸ†</div>
            <h3 style="font-size: 1.5rem; font-weight: 800; margin-bottom: var(--space-3);">ë¦¬ë”ë³´ë“œ</h3>
            <p style="line-height: 1.6; opacity: 0.9;">
                ì „ì²´ í”Œë ˆì´ì–´ì™€ ì ìˆ˜ë¥¼ ë¹„êµí•˜ê³  ë­í‚¹ì— ë„ì „í•˜ì„¸ìš”. ìµœê³  ì ìˆ˜ë¥¼ ë‹¬ì„±í•˜ê³  ëª…ì˜ˆì˜ ì „ë‹¹ì— ì´ë¦„ì„ ì˜¬ë ¤ë³´ì„¸ìš”!
            </p>
        </div>
    </div>
</section>

<!-- Login CTA (if not authenticated) -->
{% if not user.is_authenticated %}
<section class="container-fluid" style="padding: var(--space-12) var(--space-6);">
    <div class="glass-rainbow card-3d bounce-in" style="
        max-width: 800px;
        margin: 0 auto;
        padding: var(--space-12);
        border-radius: var(--radius-3xl);
        text-align: center;
    ">
        <div style="font-size: 5rem; margin-bottom: var(--space-6);">ğŸ””</div>
        <h2 class="display-lg" style="margin-bottom: var(--space-4);">
            ë¡œê·¸ì¸í•˜ê³  ê²Œì„ ì‹œì‘!
        </h2>
        <p style="font-size: 1.125rem; color: var(--text-secondary); margin-bottom: var(--space-8);">
            ê²Œì„ì„ í”Œë ˆì´í•˜ê³  ì ìˆ˜ë¥¼ ê¸°ë¡í•˜ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤
        </p>
        <div style="display: flex; gap: var(--space-4); justify-content: center; flex-wrap: wrap;">
            <a href="{% url 'common:login' %}" class="btn-liquid btn-morphing" style="
                padding: var(--space-5) var(--space-8);
                background: var(--gradient-primary);
                color: white;
                font-size: 1.125rem;
                font-weight: 700;
                text-decoration: none;
                border-radius: var(--radius-xl);
            ">
                ë¡œê·¸ì¸
            </a>
            <a href="{% url 'common:signup' %}" class="btn-liquid" style="
                padding: var(--space-5) var(--space-8);
                background: rgba(255, 255, 255, 0.2);
                color: inherit;
                font-size: 1.125rem;
                font-weight: 700;
                text-decoration: none;
                border-radius: var(--radius-xl);
                border: 1px solid rgba(255, 255, 255, 0.3);
            ">
                íšŒì›ê°€ì…
            </a>
        </div>
    </div>
</section>
{% endif %}
{% endblock %}

{% block script %}
<script>
// Magnetic effect
document.querySelectorAll('.btn-liquid, .btn-morphing').forEach(el => {
    el.addEventListener('mousemove', (e) => {
        const rect = el.getBoundingClientRect();
        const x = (e.clientX - rect.left - rect.width / 2) * 0.15;
        const y = (e.clientY - rect.top - rect.height / 2) * 0.15;
        el.style.transform = `translate(${x}px, ${y}px)`;
    });

    el.addEventListener('mouseleave', () => {
        el.style.transform = 'translate(0, 0)';
    });
});

// Bento item hover effect
document.querySelectorAll('.bento-item').forEach(el => {
    el.addEventListener('mousemove', (e) => {
        const rect = el.getBoundingClientRect();
        const x = ((e.clientX - rect.left) / rect.width) * 100;
        const y = ((e.clientY - rect.top) / rect.height) * 100;
        el.style.setProperty('--mouse-x', `${x}%`);
        el.style.setProperty('--mouse-y', `${y}%`);
    });
});
</script>
{% endblock %}
